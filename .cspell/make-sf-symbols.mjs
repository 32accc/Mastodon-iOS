import fs from 'node:fs/promises';
import { fileURLToPath } from 'node:url';

if (process.stdin.isTTY) {
    console.error("USAGE:\n");
    console.error("1. Open the SF Symbols app and select all the symbols");
    console.error("2. Copy the symbol names to the clipboard (Cmd+Shift+C)");
    console.error("3. Pipe the clipboard into this script using:");
    console.error("pbpaste | node .cspell/make-sf-symbols.mjs");
    process.exit(1);
}

const chunks = [];
for await (const chunk of process.stdin) chunks.push(chunk);

const names = Buffer.concat(chunks).toString('utf8').split('\n');
const words = new Set(names.flatMap(name => name.split('.')).filter(word => word.match(/[a-z]/)))

const warning = "# All of the words used by SF Symbol names\n# This file is auto-generated by .cspell/make-sf-symbols.mjs. DO NOT EDIT\n";
await fs.writeFile(fileURLToPath(new URL('./sf-symbols.txt', import.meta.url)), warning + [...words].sort().join('\n'));
